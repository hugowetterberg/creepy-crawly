<!DOCTYPE html>
<html>
  <head>
    <title>Creepy Crawly</title>
  </head>
  <body>
    <div id="pages">
      <dl id="page-list">
      </dl>
    </div>
    <div id="page-info">
    </div>
    <div id="stats">
    </div>

    <h2>Finished batches</h2>
    <ul id="batch-list"></ul>

    <script src="/socket.io/socket.io.js"></script>
    <script>
      var socket = io.connect('/');
      socket.on('update', function (data) {
        console.log(data);
        socket.emit('hello', { message: 'world' });
      });
      socket.on('stats', function(data) {
        console.log(data)
        mime_class = data[0].replace('/', '_');
        e = $('#stats .' + mime_class);
        if (!e.length) {
          e = $('<div>Files:<span class="files"></span><br/>Weight:<span class="weight"></span><br/>Download time:<span class="download-time"></span><br/>Parse time:<span class="parse-time"></span><br/></div>').appendTo('#stats').addClass(mime_class);
          $('<h3></h3>').text(data[0]).prependTo(e);
        }
        $('.files', e).text(data[1]);
        $('.weight', e).text(data[2]);
        $('.download-time', e).text(data[3]);
        if (data.length > 4) {
          $('.parse-time', e).text(data[4]);
        }
      });
    </script>

    <script type="text/template" id="batch-list-template">
      <li>
        <span class="id">[<%= id %>]</span>
        <span class="created"><%= prettyCreated %></span>
        <span class="files"><%= files %></span>
        <span class="size"><%= prettySize %></span>
        <span class="download-time"><%= prettyDownloadTime %></span>
      </li>
    </script>
    <script type="text/template" id="batch-stats-template">
      <li>
        <span class="id">[<%= id %>]</span>
        <span class="created"><%= prettyCreated %></span>
        <span class="files"><%= files %></span>
        <span class="size"><%= prettySize %></span>
        <span class="download-time"><%= prettyDownloadTime %></span>
      </li>
    </script>

    <script type="text/javascript" charset="utf-8" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="/underscore.js"></script>
    <script type="text/javascript" charset="utf-8" src="/backbone.js"></script>
    <script type="text/javascript" charset="utf-8" src="/app.js"></script>
  </body>
</html>
